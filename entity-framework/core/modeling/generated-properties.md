---
title: Сформированные значения — EF Core
author: rowanmiller
ms.date: 10/27/2016
ms.assetid: eb082011-11a1-41b4-a108-15daafa03e80
uid: core/modeling/generated-properties
ms.openlocfilehash: 6643d3c5c9b3363e450e820793f449a41e2eba80
ms.sourcegitcommit: 18ab4c349473d94b15b4ca977df12147db07b77f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/06/2019
ms.locfileid: "73655749"
---
# <a name="generated-values"></a>Созданные значения

## <a name="value-generation-patterns"></a>Шаблоны создания значений

Существует три шаблона создания значений, которые можно использовать для свойств:

* Без создания значения
* Значение, созданное при добавлении
* Значение, созданное при добавлении или обновлении

### <a name="no-value-generation"></a>Без создания значения

Отсутствие создания значения означает, что всегда будет предоставляться допустимое значение, сохраняемое в базе данных. Это допустимое значение должно быть назначено новым сущностям перед их добавлением в контекст.

### <a name="value-generated-on-add"></a>Значение, созданное при добавлении

Значение, созданное при добавлении, означает, что для новых сущностей создается значение.

В зависимости от используемого поставщика базы данных значения могут создаваться клиентом на стороне EF или в базе данных. Если значение создается базой данных, то EF может присвоить временное значение при добавлении сущности в контекст. Это временное значение затем будет заменено созданным значением базы данных во время `SaveChanges()`.

Если добавить сущность в контекст, имеющий значение, присвоенное свойству, то EF попытается вставить это значение вместо создания нового. Свойство считается назначенным, если ему не присвоено значение CLR по умолчанию (`null` для `string`, `0` для `int`, `Guid.Empty` для `Guid`и т. д.). Дополнительные сведения см. в разделе [явные значения для созданных свойств](../saving/explicit-values-generated-properties.md).

> [!WARNING]  
> То, как значение создается для добавленных сущностей, зависит от используемого поставщика базы данных. Поставщики баз данных могут автоматически настроить создание значений для некоторых типов свойств, но для других пользователей может потребоваться ручная настройка способа создания значения.
>
> Например, при использовании SQL Server значения будут автоматически создаваться для `GUID` свойств (с использованием алгоритма последовательного GUID SQL Server). Однако если указать, что при добавлении создается свойство `DateTime`, необходимо настроить способ создания значений. Один из способов сделать это — настроить значение по умолчанию `GETDATE()`, см. раздел [значения по умолчанию](relational/default-values.md).

### <a name="value-generated-on-add-or-update"></a>Значение, созданное при добавлении или обновлении

Значение, формируемое при добавлении или обновлении, означает, что новое значение создается при каждом сохранении записи (INSERT или Update).

Как и `value generated on add`, если указать значение для свойства только что добавленного экземпляра сущности, это значение будет вставлено вместо создаваемого значения. При обновлении также можно задать явное значение. Дополнительные сведения см. в разделе [явные значения для созданных свойств](../saving/explicit-values-generated-properties.md).

> [!WARNING]
> То, как значение создается для добавленных и обновленных сущностей, зависит от используемого поставщика базы данных. Поставщики баз данных могут автоматически настроить создание значений для некоторых типов свойств, а для других потребуется вручную настроить способ создания значения.
>
> Например, при использовании SQL Server `byte[]` свойства, которые устанавливаются, как созданные при добавлении или обновлении и помеченные как маркеры параллелизма, будут настроены с типом данных `rowversion`, чтобы в базе данных создавались значения. Однако если указать, что при добавлении или обновлении будет создано свойство `DateTime`, необходимо настроить способ создания значений. Одним из способов сделать это является настройка значения по умолчанию `GETDATE()` (см. [значения по умолчанию](relational/default-values.md)) для создания значений для новых строк. Затем можно использовать триггер базы данных для формирования значений во время обновлений (например, в следующем примере триггера).
>
> [!code-sql[Main](../../../samples/core/Modeling/FluentAPI/ValueGeneratedOnAddOrUpdate.sql)]

## <a name="conventions"></a>Соглашения

В соответствии с соглашением, Несоставные первичные ключи типа Short, int, long или GUID будут настроены для создания значений при добавлении. Все остальные свойства будут настроены без создания значений.

## <a name="data-annotations"></a>Заметки к данным

### <a name="no-value-generation-data-annotations"></a>Без создания значения (заметки к данным)

[!code-csharp[Main](../../../samples/core/Modeling/DataAnnotations/ValueGeneratedNever.cs#Sample)]

### <a name="value-generated-on-add-data-annotations"></a>Значение, созданное при добавлении (заметки к данным)

[!code-csharp[Main](../../../samples/core/Modeling/DataAnnotations/ValueGeneratedOnAdd.cs#Sample)]

> [!WARNING]  
> Это просто позволяет EF знать, что значения формируются для добавленных сущностей, но не гарантируют, что EF будет настраивать фактический механизм для создания значений. Дополнительные сведения см. [в разделе значение, созданное при добавлении](#value-generated-on-add) раздела.

### <a name="value-generated-on-add-or-update-data-annotations"></a>Значение, созданное при добавлении или обновлении (заметки к данным)

[!code-csharp[Main](../../../samples/core/Modeling/DataAnnotations/ValueGeneratedOnAddOrUpdate.cs#Sample)]

> [!WARNING]  
> Это просто позволяет EF знать, что значения формируются для добавленных или обновленных сущностей, но не гарантирует, что EF будет настраивать фактический механизм для создания значений. Дополнительные сведения см. [в разделе Добавление или обновление](#value-generated-on-add-or-update) раздела.

## <a name="fluent-api"></a>Текучий API

API-интерфейс Fluent можно использовать для изменения шаблона создания значений для данного свойства.

### <a name="no-value-generation-fluent-api"></a>Без создания значений (API Fluent)

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/ValueGeneratedNever.cs#Sample)]

### <a name="value-generated-on-add-fluent-api"></a>Значение, созданное при добавлении (API Fluent)

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/ValueGeneratedOnAdd.cs#Sample)]

> [!WARNING]  
> `ValueGeneratedOnAdd()` просто дает EF знать, что значения формируются для добавленных сущностей, но не гарантирует, что EF будет настраивать фактический механизм создания значений.  Дополнительные сведения см. [в разделе значение, созданное при добавлении](#value-generated-on-add) раздела.

### <a name="value-generated-on-add-or-update-fluent-api"></a>Значение, созданное при добавлении или обновлении (API Fluent)

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/ValueGeneratedOnAddOrUpdate.cs#Sample)]

> [!WARNING]  
> Это просто позволяет EF знать, что значения формируются для добавленных или обновленных сущностей, но не гарантирует, что EF будет настраивать фактический механизм для создания значений. Дополнительные сведения см. [в разделе Добавление или обновление](#value-generated-on-add-or-update) раздела.
