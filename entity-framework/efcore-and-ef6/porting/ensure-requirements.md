---
title: Перенос с EF6 на EF Core — проверка требований
author: rowanmiller
ms.date: 10/27/2016
ms.assetid: d3b66f3c-9d10-4974-a090-8ad093c9a53d
uid: efcore-and-ef6/porting/ensure-requirements
ms.openlocfilehash: 07caa39e8a56db71e493331ea9f0286309abc52a
ms.sourcegitcommit: 7b7f774a5966b20d2aed5435a672a1edbe73b6fb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2019
ms.locfileid: "69565345"
---
# <a name="before-porting-from-ef6-to-ef-core-validate-your-applications-requirements"></a>Перед переносом из EF6 в EF Core: Проверка требований приложения

Перед началом процесса переноса важно проверить, что EF Core соответствует требованиям к доступу к данным приложения.

## <a name="missing-features"></a>Отсутствующие компоненты

Убедитесь, что EF Core имеет все функции, необходимые для использования в приложении. Подробное сравнение того, как набор функций в EF Core сравнивается с EF6, см. в разделе [Сравнение характеристик](../features.md) . Если отсутствуют необходимые компоненты, перед переносом в EF Core убедитесь, что вы можете компенсировать отсутствие этих функций.

## <a name="behavior-changes"></a>Изменения в поведении

Это не исчерпывающий список некоторых изменений в поведении между EF6 и EF Core. Важно помнить о том, что ваш порт приложения может измениться в том виде, в каком он работает в приложении, но не будет отображаться как ошибки компиляции после переключения на EF Core.

### <a name="dbsetaddattach-and-graph-behavior"></a>Поведение DbSet. Add/Attach и Graph

В EF6 вызов `DbSet.Add()` сущности приводит к рекурсивному поиску всех сущностей, на которые имеются ссылки в свойствах навигации. Все сущности, которые обнаружены и еще не отправляются контекстом, также помечаются как добавленные. `DbSet.Attach()`ведет себя одинаково, за исключением того, что все сущности помечаются как неизмененные.

**EF Core выполняет аналогичный рекурсивный поиск, но с некоторыми разными правилами.**

*  Корневая сущность всегда находится в запрошенном состоянии (добавляется `DbSet.Add` для и не изменяется для `DbSet.Attach`).

*  **Для сущностей, найденных во время рекурсивного поиска свойств навигации:**

    *  **Если первичный ключ сущности — хранилище создано**

        * Если первичному ключу не присвоено значение, то для него устанавливается состояние добавлено. Значение первичного ключа считается "не задано", если ему присвоено значение `0` CLR по умолчанию для типа свойства (например, `int` `null` для, `string`для и т. д.).

        * Если для первичного ключа задано значение, то для него устанавливается состояние без изменений.

    *  Если первичный ключ не создается базой данных, то сущность помещается в то же состояние, что и корень.

### <a name="code-first-database-initialization"></a>Инициализация базы данных Code First

**EF6 обладает значительным количеством волшебных ИТ-проблем, связанных с выбором подключения к базе данных и инициализацией базы данных. Ниже перечислены некоторые из этих правил.**

* Если конфигурация не выполняется, EF6 выберет базу данных в SQL Express или LocalDb.

* Если строка подключения с тем же именем, что и у контекста, находится в `App/Web.config` файле приложения, будет использоваться это соединение.

* Если база данных не существует, она будет создана.

* Если ни одна из таблиц модели не существует в базе данных, то схема для текущей модели добавляется в базу данных. Если миграция включена, они используются для создания базы данных.

* Если база данных существует и EF6 ранее создала схему, то схема проверяется на совместимость с текущей моделью. Исключение возникает, если модель изменилась с момента создания схемы.

**EF Core не выполняет никаких этих волшебных работ.**

* Подключение к базе данных должно быть явно настроено в коде.

* Инициализация не выполняется. Для применения миграции `DbContext.Database.Migrate()` ( `DbContext.Database.EnsureCreated()` `EnsureDeleted()` или для создания или удаления базы данных без использования миграций) необходимо использовать.

### <a name="code-first-table-naming-convention"></a>Соглашение об именовании таблиц Code First

EF6 запускает имя класса сущности через службу множественного преобразования, чтобы вычислить имя таблицы по умолчанию, с которой сопоставлена сущность.

EF Core использует имя `DbSet` свойства, которое предоставляется сущностью в производном контексте. Если сущность не имеет `DbSet` свойства, используется имя класса.
